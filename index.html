<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>JS Experiments</title>
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Arimo" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Cabin" />
    <style>
      body{
        margin: auto 0;
        background: #fff;
        height: 100%;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      }

      .header-cont{
        background: -webkit-linear-gradient(left top, #084a58, #177b90);
        position: fixed;
        width: 100%;
        font-size: 23px;
        height: 120px;
        display: block;
        margin: auto 0;
        z-index: 999;
      }

      .header-shrink{
        height: 80px;
        transition: height 300ms;
      }

      .header-shrink h1{
        font-size: 33px;
      }

      .header-shrink header{
        padding-top: 20px;
      }

      header{
        display: block;
        height: 100%;
        padding-top: 20px;
      }

      h1{
        padding-left: 140px;
        text-shadow: 5px 0px #000000;
        color: #fff;
        font-weight: 200;
        margin-top: 0;
      }

      .main-container {
        padding-top: 120px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      .tool-cont{
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .canvas-cont{
        height: 100%;
      }

      .crop-transition{
        transition: transform 200ms;
        text-shadow: 0 0 #fff;
        transform: rotate(45deg);
        display: inline-block;
        border: 1px dashed #fff;
        color: #fff;
        margin: 0px 14px;
      }

      .btn-cont{
        padding: 14px;
        background: #efefef;
      }

      button{
        width: 60px;
        height: 40px;
        background: rgb(45, 154, 177);
        border: 0;
        color: white;
        margin-left: 10px;
        border-radius: 4px;
        font-size: 13px;
        outline: none;
      }

      #crop-canvas{
        display: none;
      }

      .description{
        margin: 40px 0;
        font-size: 1em;
        line-height: 1.5;
        font-weight: 300;
        color: #3c3c3c;
        width: 750px;
      }

      .placeholder-div{
        position: relative;
        box-shadow: 2px -2px 10px 2px rgb(158, 158, 158);
        margin-top: 20px;
        width: 568px;
        text-align: center;
        height: 320px;
      }

      .placeholder-div p{
        font-family: sans-serif;
        color: grey;
        font-size: 14px;
      }

      .sample-img{
        width: 568px;
        height: 320px;
      }

    .crop-select {
        position: absolute;
        resize: both;
        width: 20px;
        height: 20px;
        overflow: auto;
        background: transparent;
        border: 2px dashed #fff;
        background: rgba(0, 0, 0, 0.23);
        top: 400px;
        left: 500px;
    }

    .crop-canvas-background{
      filter: opacity(0.6) brightness(0.4);
    }

    #filter-canvas{
      border: 1px dashed #fff;
      z-index: 10;
      position: absolute;
      display: none;
    }

    .grayscale-filter{
      filter: grayscale(1);
    }

    .rainy-filter{
      filter: grayscale(0.4) saturate(0.7);
    }

    .evening-filter{
      filter: hue-rotate(-40deg);
    }

    .dawn-filter{
      filter: hue-rotate(-20deg);
    }

    .sepia-filter{
      filter: sepia(1);
    }

    input, .hide{
      display: none;
    }

    .show{
      display: block;
    }

    .filters-cont{
      margin: 50px 0;
    }

    .filter-box {
      display: inline-block;
      margin-left: 25px;
      width: 100px;
    }

    .filter-box img{
      object-fit: contain;
      width: 100%;
      border: 1px solid grey;
    }

    .filter-box p{
      margin: 0;
      font-size: 1em;
      line-height: 1.5;
      font-weight: 300;
      color: #3c3c3c;
    }

    </style>
</head>

<body onscroll="resizeHeader()">
  <div class="header-cont" id="main-header">
    <header>
      <h1>Cr<span class="heading-span">op</span> and Filter</h1>
    </header>
  </div>
  <div class="main-container">
    <div class="description">
      <p>Pure javascript tool to crop images using canvas and apply different kinds of filters provided by css3 and HTML5 canvas.
         Use the sample image below to try the filters on or upload any landscape image(for now ;) and have fun with crop tool and filters</p>
    </div>
    <div class="tool-cont">
      <div class="canvas-cont">
        <div class="btn-cont effect-toolbar">
          <button class="crop-btn" onclick="createCropArea('event')">Crop</button>
          <button class="upload-btn" onclick="uploadImage('event')">Upload</button>
          <button class="crop-done" onclick="cropAreaSelelcted('event')">Done</button>
          <button class="crop-done">Reset</button>
        </div>
        <div class="placeholder-div">
          <input type="file" id="image-input" accept="image/*" onchange="imageUpload('event')" >
          <img src="images/flowers.jpg" class="sample-img" />
          <canvas id="filter-canvas">
            An alternative text describing what your canvas displays.
          </canvas>
          <canvas id="crop-canvas" width="568" height="320">
            An alternative text describing what your canvas displays.
          </canvas>
        </div>
      </div>
      <div class="filters-cont">
        <div class="filter-box grayscale-filter" onclick="applyFilter('grayscale')">
          <img class"filter-img grayscale-filter" src="./images/flowers.jpg"/>
          <p>Grayscale</p>
        </div>
        <div class="filter-box sepia-filter" onclick="applyFilter('sepia')">
          <img class"filter-img sepia-filter" src="./images/flowers.jpg"/>
          <p>Sepia</p>
        </div>
        <div class="filter-box rainy-filter" onclick="applyFilter('rainy')">
          <img class"filter-img rainy-filter" src="./images/flowers.jpg"/>
          <p>Rainy</p>
        </div>
        <div class="filter-box evening-filter" onclick="applyFilter('evening')">
          <img class"filter-img evening-filter" src="./images/flowers.jpg"/>
          <p>Evening</p>
        </div>
        <div class="filter-box focus-filter" onclick="applyFilter('dawn')">
          <img class"filter-img focus-filter" src="./images/flowers.jpg"/>
          <p>Dawn<p>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript" src="./canvas-script.js"></script>
  <script>
    var _document = document;
    var cropTopOffset;
    var cropLeftOffset;
    var cropCanvas = _document.getElementById('crop-canvas');
    var cropContext = cropCanvas.getContext("2d");
    var cropImage = new Image();
    /***top header style*****/
    var heading =  document.getElementById("main-header");
    heading.addEventListener("mouseover", function(){
      var transitionSpan = _document.getElementsByClassName("heading-span")[0];
      transitionSpan.classList.add('crop-transition');
    });
    heading.addEventListener("mouseout", function(){
      var transitionSpan = _document.getElementsByClassName("heading-span")[0];
      transitionSpan.classList.remove('crop-transition');
    });

    function resizeHeader(){
      var headerElement = document.getElementById("main-header");
      if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
          headerElement.classList.add('header-shrink');
      } else {
          headerElement.classList.remove('header-shrink');
      }
    }

    var cropCanvasLib = new CropCanvasLib();

    function createCropArea(){
      cropCanvasLib.createCropArea();
    }

    function cropAreaSelelcted(e){
      cropCanvasLib.cropAreaSelelcted(e);
    }

    function uploadImage(){
      var input = document.querySelector('input');
      input.click();
    }

    function imageUpload(event){
      cropCanvasLib.uploadImage(event);
    }

    function applyGwFilter(){
      var filterCanvas = document.querySelector('#filter-canvas');
      filterCanvas.classList.add('grascale-filter');
    }

    function applySepiaFilter(){
      var filterCanvas = document.querySelector('#filter-canvas');
      filterCanvas.classList.add('sepia-filter');
    }

    function applyFilter(filter){
      cropCanvasLib.applyFilter(filter);
    }
  </script>
</body>
</html>
