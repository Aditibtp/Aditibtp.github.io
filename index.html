<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>JS Experiments</title>
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Arimo" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Cabin" />
    <style>
      body{
        margin: auto 0;
        background: #fff;
        height: 100%;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      }

      .header-cont{
        background: -webkit-linear-gradient(left top, #084a58, #177b90);
        font-size: 23px;
        height: 140px;
        position: relative;
        top: -22px;
        display: block;
        margin: auto 0;
      }

      header{
        display: block;
        padding-top: 20px;
      }

      h1{
        padding-left: 140px;
        text-shadow: 5px 0px #000000;
        color: #fff;
        font-weight: 200;
      }

      .tool-cont{
        padding-left: 23%;
        width:65%;
        height: 500px;
      }

      .canvas-cont{
        float: left;
        height: 100%;
        width: 50%;
      }

      .result-cont{
        float: right;
        height: 100%;
        width: 50%;
      }

      .crop-transition{
        transition: transform 200ms;
        text-shadow: 0 0 #fff;
        transform: rotate(45deg);
        display: inline-block;
        border: 1px dashed #fff;
        color: #fff;
        margin: 0px 14px;
      }

      .btn-cont{
        padding-top: 20px;
        padding-left: 40px;
      }

      button{
        width: 70px;
        height: 40px;
        background: #03a9f4;
        border: 0;
        color: white;
        border-radius: 4px;
        font-size: 14px;
        outline: none;
      }

      #crop-canvas{
        display: none;
      }

      .description{
        font-size: 1em;
        line-height: 1.5;
        font-weight: 300;
        color: #3c3c3c;
        padding-left: 250px;
        width: 750px;
      }

      .placeholder-div{
        position: relative;
        box-shadow: 2px -2px 10px 2px rgb(158, 158, 158);
        margin-top: 40px;
        margin-left: 40px;
        width: 568px;
        text-align: center;
        height: 320px;
      }

      .placeholder-div p{
        font-family: sans-serif;
        color: grey;
        font-size: 14px;
      }

      .sample-img{
        width: 568px;
        height: 320px;
      }

    .crop-select {
        position: absolute;
        resize: both;
        width: 20px;
        height: 20px;
        overflow: auto;
        background: transparent;
        border: 2px dashed #fff;
        background: rgba(0, 0, 0, 0.23);
        top: 300px;
        left: 400px;
    }

    .crop-canvas-background{
      filter: opacity(0.6) brightness(0.4);
    }

    #filter-canvas{
      border: 1px dashed #fff;
      z-index: 10;
      position: absolute;
      display: none;
    }

    .grascale-filter{
      filter: grayscale(1);
    }

    .rainy-filter{
      filter: grayscale(0.4) saturate(0.7);
    }

    .evening-filter{
      filter: hue-rotate(-40deg);
    }

    .dawn-filter{
      filter: hue-rotate(-20deg);
    }

    .sepia-filter{
      filter: sepia(1);
    }

    input, .hide{
      display: none;
    }

    .show{
      display: block;
    }

    </style>
</head>

<body>
  <div class="header-cont">
    <header>
      <h1>Cr<span class="heading-span">op</span> and Filter</h1>
    </header>
  </div>
  <div class="description">
    <p>Pure javascript tool to crop images using canvas and apply different kinds of filters provided by css3 and HTML5 canvas.
       Use the sample image below to try the filters on or upload any landscape image(for now ;) and have fun with crop tool and filters</p>
  </div>
  <div class="tool-cont">
    <div class="canvas-cont">
      <div class="placeholder-div">
        <input type="file" id="image-input" accept="image/*" onchange="imageUpload('event')" >
        <img src="images/flowers.jpg" class="sample-img" />
        <canvas id="filter-canvas">
          An alternative text describing what your canvas displays.
        </canvas>
        <canvas id="crop-canvas" width="568" height="320">
          An alternative text describing what your canvas displays.
        </canvas>
      </div>
      <div class="btn-cont effect-toolbar">
        <button class="crop-btn" onclick="createCropArea('event')">Crop</button>
        <button class="upload-btn" onclick="uploadImage('event')">Upload</button>
        <button class="crop-done" onclick="cropAreaSelelcted('event')">Done</button>
        <button class="crop-btn gw-btn-filter" onclick="applyFilter('grayscale')">G/W</button>
        <button class="crop-btn sepia-btn-filter" onclick="applyFilter('sepia')">Sepia</button>
        <button class="crop-btn sepia-btn-filter" onclick="applyFilter('rainy')">Rainy</button>
        <button class="crop-btn sepia-btn-filter" onclick="applyFilter('evening')">Evening</button>
        <button class="crop-btn sepia-btn-filter" onclick="applyFilter('dawn')">Dawn</button>
      </div>
    </div>
  </div>

  <script type="text/javascript" src="./canvas-script.js"></script>
  <script>
    var _document = document;
    var cropTopOffset;
    var cropLeftOffset;
    var cropCanvas = _document.getElementById('crop-canvas');
    var cropContext = cropCanvas.getContext("2d");
    var cropImage = new Image();
    /***top header style*****/
    var heading = _document.getElementsByTagName("h1")[0];
    heading.addEventListener("mouseover", function(){
      var transitionSpan = _document.getElementsByClassName("heading-span")[0];
      transitionSpan.classList.add('crop-transition');
    });
    heading.addEventListener("mouseout", function(){
      var transitionSpan = _document.getElementsByClassName("heading-span")[0];
      transitionSpan.classList.remove('crop-transition');
    });

    var cropCanvasLib = new CropCanvasLib();

    function createCropArea(){
      cropCanvasLib.createCropArea();
    }

    function cropAreaSelelcted(e){
      cropCanvasLib.cropAreaSelelcted(e);
    }

    function uploadImage(){
      var input = document.querySelector('input');
      input.click();
    }

    function imageUpload(event){
      cropCanvasLib.uploadImage(event);
    }

    function applyGwFilter(){
      var filterCanvas = document.querySelector('#filter-canvas');
      filterCanvas.classList.add('grascale-filter');
    }

    function applySepiaFilter(){
      var filterCanvas = document.querySelector('#filter-canvas');
      filterCanvas.classList.add('sepia-filter');
    }

    function applyFilter(filter){
      cropCanvasLib.applyFilter(filter);
    }
  </script>
</body>
</html>
